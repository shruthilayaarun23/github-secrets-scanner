secret:
  config:
    disable-allow-rules: true
    
    rules:
      # Generic patterns
      - id: generic-api-key
        category: general
        title: Generic API Key
        severity: HIGH
        regex: '(?i)(api[_-]?key|apikey)\s*[=:]\s*["'']?([A-Z0-9_]{10,})["'']?'
        keywords:
          - API_KEY
          - APIKEY
      
      - id: generic-secret-key
        category: general
        title: Generic Secret Key
        severity: HIGH
        regex: '(?i)(secret[_-]?key|secret)\s*[=:]\s*["'']?([A-Za-z0-9_-]{15,})["'']?'
        keywords:
          - SECRET_KEY
          - SECRET
      
      - id: database-password
        category: general
        title: Database Password
        severity: CRITICAL
        regex: '(?i)(db[_-]?password|database[_-]?password|db[_-]?pass|postgres[_-]?password|mysql[_-]?password|mysql[_-]?root[_-]?password)\s*[=:]\s*["'']?([^\s"'']{8,})["'']?'
        keywords:
          - DB_PASSWORD
          - DATABASE_PASSWORD
          - POSTGRES_PASSWORD
          - MYSQL_PASSWORD
      
      - id: root-password
        category: general
        title: Root/Admin Password
        severity: CRITICAL
        regex: '(?i)(root[_-]?password|admin[_-]?password)\s*[=:]\s*["'']?([^\s"'']{8,})["'']?'
        keywords:
          - ROOT_PASSWORD
          - ADMIN_PASSWORD
      
      - id: jwt-secret
        category: general
        title: JWT Secret
        severity: HIGH
        regex: '(?i)(jwt[_-]?secret|jwt[_-]?key)\s*[=:]\s*["'']?([A-Za-z0-9_-]{16,})["'']?'
        keywords:
          - JWT_SECRET
          - JWT_KEY
      
      - id: encryption-key
        category: general
        title: Encryption Key
        severity: CRITICAL
        regex: '(?i)(encryption[_-]?key|secret[_-]?key[_-]?base)\s*[=:]\s*["'']?([A-Za-z0-9+/=_-]{20,})["'']?'
        keywords:
          - ENCRYPTION_KEY
          - SECRET_KEY_BASE
      
      - id: oauth-secret
        category: general
        title: OAuth Client Secret
        severity: HIGH
        regex: '(?i)(oauth[_-]?client[_-]?secret|client[_-]?secret)\s*[=:]\s*["'']?([A-Za-z0-9_-]{20,})["'']?'
        keywords:
          - OAUTH_CLIENT_SECRET
          - CLIENT_SECRET
      
      - id: bearer-token
        category: general
        title: Bearer/Auth Token
        severity: HIGH
        regex: '(?i)(bearer[_-]?token|auth[_-]?token|access[_-]?token)\s*[=:]\s*["'']?([A-Za-z0-9_.-]{20,})["'']?'
        keywords:
          - BEARER_TOKEN
          - AUTH_TOKEN
      
      # Private keys
      - id: private-key-rsa
        category: general
        title: RSA Private Key
        severity: CRITICAL
        regex: '-----BEGIN RSA PRIVATE KEY-----[\s\S]+?-----END RSA PRIVATE KEY-----'
        keywords:
          - BEGIN RSA PRIVATE KEY
      
      - id: private-key-openssh
        category: general
        title: OpenSSH Private Key
        severity: CRITICAL
        regex: '-----BEGIN OPENSSH PRIVATE KEY-----[\s\S]+?-----END OPENSSH PRIVATE KEY-----'
        keywords:
          - BEGIN OPENSSH PRIVATE KEY
      
      - id: private-key-generic
        category: general
        title: Generic Private Key
        severity: CRITICAL
        regex: '-----BEGIN [A-Z ]+PRIVATE KEY-----[\s\S]+?-----END [A-Z ]+PRIVATE KEY-----'
        keywords:
          - PRIVATE KEY
      
      # Cloud providers
      - id: aws-session-token
        category: cloud
        title: AWS Session Token
        severity: CRITICAL
        regex: '(?i)(aws[_-]?session[_-]?token)\s*[=:]\s*["'']?([A-Za-z0-9+/=]{100,})["'']?'
        keywords:
          - AWS_SESSION_TOKEN
      
      - id: azure-client-secret
        category: cloud
        title: Azure Client Secret
        severity: CRITICAL
        regex: '(?i)(azure[_-]?client[_-]?secret)\s*[=:]\s*["'']?([A-Za-z0-9~._-]{34,})["'']?'
        keywords:
          - AZURE_CLIENT_SECRET
      
      - id: gcp-api-key
        category: cloud
        title: Google Cloud API Key
        severity: HIGH
        regex: '(?i)(google[_-]?api[_-]?key)\s*[=:]\s*["'']?(AIza[A-Za-z0-9_-]{35})["'']?'
        keywords:
          - GOOGLE_API_KEY
      
      # Databases
      - id: mongodb-connection
        category: database
        title: MongoDB Connection String
        severity: CRITICAL
        regex: 'mongodb(\+srv)?://[^:]+:[^@]+@[^\s"''<>]+'
        keywords:
          - mongodb://
          - MONGO_URI
      
      - id: postgres-connection
        category: database
        title: PostgreSQL Connection String
        severity: CRITICAL
        regex: 'postgres(ql)?://[^:]+:[^@]+@[^\s"''<>]+'
        keywords:
          - postgresql://
          - DATABASE_URL
      
      - id: mysql-connection
        category: database
        title: MySQL Connection String
        severity: CRITICAL
        regex: 'mysql://[^:]+:[^@]+@[^\s"''<>]+'
        keywords:
          - mysql://
      
      # Payment processors
      - id: stripe-webhook-secret
        category: payment
        title: Stripe Webhook Secret
        severity: HIGH
        regex: 'whsec_[0-9a-zA-Z]{32,}'
        keywords:
          - whsec_
      
      # Communication
      - id: sendgrid-api
        category: communication
        title: SendGrid API Key
        severity: HIGH
        regex: 'SG\.[A-Za-z0-9_-]{22}\.[A-Za-z0-9_-]{43}'
        keywords:
          - SG.
          - SENDGRID_API_KEY
      
      # AI services
      - id: openai-api
        category: ai
        title: OpenAI API Key
        severity: HIGH
        regex: 'sk-proj-[A-Za-z0-9]{48,}'
        keywords:
          - sk-proj-
          - OPENAI_API_KEY
